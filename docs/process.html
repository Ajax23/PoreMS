<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Operating principle &#8212; PoreMS 0.2.0 documentation</title>
    <link rel="stylesheet" href="_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/style.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.2.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="_static/js/jquery-1.11.0.min.js "></script>
<script type="text/javascript" src="_static/js/jquery-fix.js "></script>
<script type="text/javascript" src="_static/bootstrap-3.3.7/js/bootstrap.min.js "></script>
<script type="text/javascript" src="_static/bootstrap-sphinx.js "></script>

  </head>
  <body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="index.html">
          PoreMS</a>
        <span class="navbar-text navbar-version pull-left"><b>0.2</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="api.html">API</a></li>
                <li><a href="#">Porcess</a></li>
                <li><a href="molecule.html">Molecule</a></li>
                <li><a href="pore.html">Pore</a></li>
                <li><a href="workflow.html">Workflow</a></li>
                <li><a href="0.1.2/index.html">V 0.1.2</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"></ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">Operating principle</a><ul>
<li><a class="reference internal" href="#molecule-generation">Molecule Generation</a></li>
<li><a class="reference internal" href="#pore-generation">Pore Generation</a><ul>
<li><a class="reference internal" href="#pattern">Pattern</a></li>
<li><a class="reference internal" href="#shape">Shape</a></li>
<li><a class="reference internal" href="#preparation">Preparation</a></li>
<li><a class="reference internal" href="#dice">Dice</a></li>
<li><a class="reference internal" href="#matrix">Matrix</a></li>
</ul>
</li>
<li><a class="reference internal" href="#store">Store</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <div class="container-fluid">
  <div class="row">
    <div class="col-md-10">
      <div style="text-align: justify; text-justify: inter-word;"><div class="section" id="operating-principle">
<h1>Operating principle<a class="headerlink" href="#operating-principle" title="Permalink to this headline">¶</a></h1>
<p>A pore generation package for molecular simulations (PoreMS) has been programmed in an object-oriented manner using python 3. The main idea was maximizing individual customizational possibilities without obscuring usability.
For this purpose, the core piece of this tool is a molecule construction set containing functions to place, translate, and rotate atoms in a three-dimensional space. Hence custom molecules and systems can be created in the required specification, for example moving a molecule into the binding pocket of an enzyme as a starting configuration of a simulation.</p>
<p>The construction of a pore takes place in multiple steps from creating a grid pattern, carving out geometrical shapes and functionalize the surface. Accelerating optimization logic has been separated into custom classes in order to reduce clutter and simplify readability.</p>
<p>Finally, a storage class was implemented which translates the generated data construct into the most popular structure file-formats to be used in molecular simulations.</p>
<div class="section" id="molecule-generation">
<h2>Molecule Generation<a class="headerlink" href="#molecule-generation" title="Permalink to this headline">¶</a></h2>
<p>Initially the idea behind the molecule class was an easy construction of geometries, which during development got more tuned towards molecules, containing specific information like mass and charge. Atoms can be added using specified positions or based on the location of other atoms, hereby using spherical coordinates. The underlying data structure is a list of atom objects, with each of these objects containing the atom position, atom type, and atom name. Based on these positional information, geometrical functions were implemented assuring that any desired arrangement of atoms and molecules can be realized.</p>
</div>
<div class="section" id="pore-generation">
<h2>Pore Generation<a class="headerlink" href="#pore-generation" title="Permalink to this headline">¶</a></h2>
<p>In order to create an ideal pore structure with the desired dimensions and diameter, multiple steps are involved.</p>
<div class="section" id="pattern">
<h3>Pattern<a class="headerlink" href="#pattern" title="Permalink to this headline">¶</a></h3>
<p>First, using the constructional capabilities of the molecule class, a pattern class has been devised, which creates a minimal <span class="math">\(\beta\)</span>-cristobalite crystal structure ref{fig:11} using the bond angle and length</p>
<div class="math">
\[\alpha_\text{O-Si-O}=\frac{2\cdot180}{\pi}\tan^{-1}\sqrt2=109.47^\circ,\ \ \ l_\text{Si-O}=0.155\ \text{nm}.\]</div>
<p>This is necessary to assure the requested system size is achieved as best as possible by multiplying this minimal structure in all dimensions. The resulting <span class="math">\(\beta\)</span>-cristobalite block has bond lengths and angles between all silicon and oxygen atoms that are identical, and is thus feasible to be called an ideal crystal. Using the provided pattern class as a basis, other structural patterns can be created if needed.</p>
<div class="figure align-center" id="fig1">
<a class="reference internal image-reference" href="_images/struct.svg"><img alt="Minimal structure viewed from different perspectives." src="_images/struct.svg" width="70%" /></a>
</div>
<p><strong>Figure 1:</strong> Minimal structure of <span class="math">\(\beta\)</span>-cristobalite viewed (a) from the <span class="math">\(xy\)</span>-plane, (b) from the <span class="math">\(yz\)</span>-plane (c) and from the <span class="math">\(xz\)</span>-plane. Silicon atoms are colored yellow and oxygen atoms orange.</p>
</div>
<div class="section" id="shape">
<h3>Shape<a class="headerlink" href="#shape" title="Permalink to this headline">¶</a></h3>
<p>Out of this molecule block, a volume is carved out by removing all atoms within a hypothetical shape placed inside the system. Sub classes of the pattern class have been created defining the basic geometrical forms like cylindrical and spherical shapes. Other volumetric shapes can be created by combining provided classes or by defining own shapes using the provided ones as an example.</p>
</div>
<div class="section" id="preparation">
<h3>Preparation<a class="headerlink" href="#preparation" title="Permalink to this headline">¶</a></h3>
<p>For the purpose of ensuring chemical propriety, the carved out surface needs to be processed based on a set of rules as proposed by Coasne et al. cite{Coasne:2008}. First, all unsaturated silicon atoms are to be removed. Next, silicon atoms with three unsaturated oxygen bonds are eliminated. Finally, now unbound oxygen atoms must be deleted. The resulting surface has fully saturated silicon atoms with a maximum of two unsaturated oxygen bonds, the latter will be used as binding sites to connect molecules that are to be placed on the surface.</p>
<p>However, each processing step involves a high computational effort. In every step, the number of bonds for all atoms must be determined by comparing the distances of each atom to all other atoms. Typically, this effort scales quadratically with the number of atoms</p>
<div class="math">
\[\mathcal O(n^2).\]</div>
<p>An effort, that is adverse for highly scalable systems. Once the surface is prepared and binding sites are determined, it is possible to attach molecules on the surface using implemented functions that automatically rotate the groups perpendicular to surface using normal vectors implemented in the shape classes.</p>
</div>
<div class="section" id="dice">
<h3>Dice<a class="headerlink" href="#dice" title="Permalink to this headline">¶</a></h3>
<p>As mentioned, the effort for determining the bonds of each atom is unpractical, since it scales quadratically. An excellent solution is provided by the algorithms used in molecular simulations when considering short ranged interactions. These have a converging error when introducing a cut-off radius to the potential function. Atoms farther than the cut-off radius are neglected from the calculation. Similarly, bond lengths are constant. Therefore, it is only necessary to search for bonds in the close vicinity of an atom.</p>
<p>The implemented algorithm splits the whole system into smaller cubes of the same size which contain intersecting atoms. A scan for the bonds of an atom is then performed solely in the cube that contains the atom and the immediate neighboring cubes, a total of 27 cubes. The computational effort for each atom is thus a constant</p>
<div class="math">
\[\mathcal{O}(27\cdot b^2)\]</div>
<p>since due to the geometrical ideal nature of the crystal, the number of atoms <span class="math">\(b\)</span> in a cube is constant. Therefore, the computational effort for an entire search scales linear with the number of cubes. For example, doubling the cristobalite block size only increases the effort eightfold.</p>
<p>Furthermore, the search is easily parallelizable, since no communication is needed between the subprocesses that each cover a set of cubes. The effort therefore has an ideal speedup.</p>
</div>
<div class="section" id="matrix">
<h3>Matrix<a class="headerlink" href="#matrix" title="Permalink to this headline">¶</a></h3>
<p>Although the search can be parallelized, still multiple iterations are needed to cover the surface preparations. Additionally, due to machine inaccuracy there is the risk of bonds not being detected as such, leading to artefacts. Also, it is not possible to ensure that all bonds were found when deleting atoms, because all systems are shaped differently. Therefore, another optimization, or rather supporting algorithm, was implemented to bypass these issues.</p>
<p>The idea was reducing the number of iterations to a single search by creating a connectivity matrix of all grid atoms. The result is a dictionary that has atoms <span class="math">\(1\dots n\)</span> as keys and their corresponding value is a list of bonded atoms <span class="math">\(1\dots m\)</span></p>
<div class="math">
\[\begin{split}\boldsymbol{C}=
\begin{Bmatrix}
    a_1:&amp;\begin{bmatrix}a_{1,1}&amp;a_{1,2}&amp;\dots&amp;a_{1,m_1}\end{bmatrix}\\
    a_2:&amp;\begin{bmatrix}a_{2,1}&amp;a_{2,2}&amp;\dots&amp;a_{2,m_2}\end{bmatrix}\\
    \vdots&amp;\vdots\\
    a_n:&amp;\begin{bmatrix}a_{n,1}&amp;a_{n,2}&amp;\dots&amp;a_{n,m_n}\end{bmatrix}\\
\end{Bmatrix}\end{split}\]</div>
<p>Using this implementation, it is no longer required to physically delete atoms when carving out a structure, it is enough to remove binding partners from the matrix. For example, conditions for the surface preparation only need to consider the number of bonds remaining in each entry and thereby determine whether an atom needs to be removed or not, resulting into a negligible computational effort scaling linear with the number of atoms</p>
<div class="math">
\[\mathcal{O}(n).\]</div>
<p>A convenient by-product of the implemented optimizations is the ability to carve out the cristobalite crystal in every orientational axis with an arbitrary pore shape.</p>
</div>
</div>
<div class="section" id="store">
<h2>Store<a class="headerlink" href="#store" title="Permalink to this headline">¶</a></h2>
<p>Molecules and pores generated using the described classes, can be converted to a readable structure in the most generic formats using the storing functionalities. These functions were separated into an own class to allow an accessible way to extend the capabilities to other needed formats.</p>
      </div>
    </div>
  </div>
</div></div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2020, Hamzeh Kraus.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.6.6.<br/>
    </p>
  </div>
</footer>
  </body>
</html>